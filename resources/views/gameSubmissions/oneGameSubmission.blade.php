@extends('layouts.frontEnd')

@section('pageTitle')
    Game Name
@endsection

@section('cssfiles')
    <link href="{{asset('css/game.css')}}" rel="stylesheet" type="text/css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.3.4/assets/owl.carousel.min.css" rel="stylesheet"
          type="text/css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/magnific-popup.js/1.1.0/magnific-popup.min.css">
@endsection

@section('addClassesToBodyCover')
    one-game-container
@endsection

@section('content')
    <div class="game-cover-image-wrap">
        <div class="game-cover-image" style="background-image: url('{{ asset($gameSubmission->path) }}')">
        </div>
    </div>

    <div class="game-header">
        <div class="game-header-inner container">
            <div class="game-header-left float-left">
                <div>
                    <h2 class="game-jam-header-title">{{ $gameSubmission->title }}</h2>
                    <span>Submited by <a
                                href="{{ asset('/user/' . $gameSubmission->username) }}">{{ $gameSubmission->username }}</a></span>
                    <span style="color: #888;"> at {{ \App\Http\Models\Utilities::PrintDateTime( $gameSubmission->createdAt )}} </span>
                </div>
            </div>
            <div class="game-header-right float-right">
                <div class="row text-center">
                    <div class="col-md-8">
                        <div id="gameNumOfDownloads">{{ $gameSubmission->numOfDownloads }}</div>
                        <div>downloads</div>
                    </div>
                    <div class="col-md-4">
                        <div>{{ $gameSubmission->numOfViews }}</div>
                        <div>views</div>
                    </div>
                </div>
            </div>
            <div class="clearfix"></div>
        </div>
    </div>

    <div class="game-header">
        <div class="game-header-inner container text-center">
            @if(count($gameSubmissionScreenShots))
                <div class="carousel-wrap">
                    <div class="owl-carousel">
                        @foreach($gameSubmissionScreenShots as $screenShot)
                            <div class="item">
                                <a href="{{asset($screenShot->path)}}">
                                    <img src="{{asset($screenShot->path)}}" alt="game submission screenshot">
                                </a>
                            </div>
                        @endforeach
                    </div>
                </div>
            @else
                <i>There is currently no screenshots for this game.</i>
            @endif

            <div class="clearfix"></div>
        </div>
    </div>

    <div class="game-content container" style="padding: 0 20px;">

    @if(session()->has('user') && session()->get('user')[0]->idUser == $gameSubmission->idUser)
        <!-- edit and remove -->
            <div class="row">
                <div class="col-md-4">
                    <a class="btn btn-primary"
                       href="{{asset('/games/'. $gameSubmission->idGameSubmission.'/edit')}}">Edit</a>
                    <a href="#" id="btn-remove-game-jam" data-url="{{asset('/games/'. $gameSubmission->idGameSubmission.'/delete')}}" data-text="Are you sure you want to remove this game?" class="btn btn-danger">Remove</a>
                </div>
            </div>
            <br>
            <br>
        @endif


        <div class="row">
            <div class="col-md-8 col-xs-12">
                <div class="col-md-12 gs-min-height-100" style="padding: 0 0 30px 0;">
                    <h4>Downloads:</h4>
                    <br>

                    @foreach($gameSubmissionDownloadFiles as $gameFiles)
                        <div class="row download-row-game-submission">
                            <div>
                                <div class="col-md-3">
                                    {{--
                                    session()->has('user')
                                    // we can make that user needs to be logedin first to be able to download files
                                    --}}
                                    <a class="btn btn-block btn-social btn-bitbucket" href="{{asset('/download/'.$gameFiles->idDownloadFile)}}" onclick="slamjam.downloads.increment()">
                                        <i class="fa fa-download"></i>
                                        Download
                                    </a>
                                </div>
                                <div class="col-md-6" style="padding: 8px 0 0 8px;">{{$gameFiles->name}}</div>
                                <div class="col-md-3 text-right" style="padding: 8px 20px 0 8px;">
                                    {{\App\Http\Models\Utilities::FormatBytes($gameFiles->size)}}
                                    <i class="{{$gameFiles->classNameForIcon}}"></i>
                                </div>
                            </div>
                        </div>
                    @endforeach

                </div>
                <div class="col-md-12 gs-min-height-100" style="padding: 0;">
                    <h4>Description:</h4>
                    <br>
                    <p>{{$gameSubmission->description}}</p>
                </div>
            </div>

            <div class="col-md-4 col-xs-12 gs-min-height-100">
                <h4>Badges:</h4>
                <br>
                @if(session()->has('user') && session()->get('user')[0]->idUser != $gameSubmission->idUser)
                    <form class="row">
                        <div class="col-md-8 col-xs-8 col-sm-8">
                            <select class="form-control" id="gamesBadgesList">
                                <option selected disabled>Select game badge...</option>
                                @foreach($gameBadgesList as $gameBadge)
                                    <option value="{{$gameBadge->idGameBadges}}">{{$gameBadge->name}}</option>
                                @endforeach
                            </select>
                        </div>
                        <div class="col-md-4">
                            <button type="button" class="btn btn-primary pull-right" id="btnAddBadge">
                                Add Badge
                            </button>
                        </div>
                    </form>
                @elseif(!session()->has('user'))
                    <i>Please <a href="{{asset('/login')}}">login</a> to add badge to this <b>game</b>.</i>
                @endif

                <br>
                <br>

                <div class="row" id="badgesRenderedList">

                    {{--
                    <!-- foreach -->
                    <div class="col-md-4 col-xs-6 col-sm-4">
                        <img style="width: 100%;" src="{{asset('images/badges/audio.png')}}" alt="badge name" title="badge name">
                    </div>
                    <!-- / foreach -->
                    --}}

                </div>
            </div>

        </div>
        <hr>
        <div class="row">
            <div class="col-md-offset-2 col-md-8 col-xs-offset-0 col-xs-12 gs-min-height-100"
                 style="background-color: #dfdfdf">
                <h4>Comments:</h4>
                <br>

                <!-- Add comment -->
                <!-- make it as one component and just insert it->
                <!-- javascript will decide where to put comment -->
                <div id="add-comment">

                    <div class="row">
                        <form class="col-md-12">
                            <div class="form-group">
                                <label>Post a new Comment</label>
                                <textarea class="form-control resize-vertical" rows="3" id="comment" name="comment"
                                          {{session()->has('user')? '': 'disabled' }} placeholder="{{session()->has('user')? 'Comment text...': 'Please login into your accout to post comments' }}"></textarea>
                            </div>
                            <div class="form-group">
                                @if(session()->has('user'))
                                    <button type="button" class="btn btn-primary pull-right" id="btnAddComment">
                                        Add Comment
                                    </button>
                                @else
                                    <a class="btn btn-primary pull-right" href="{{asset('/login')}}">Login to
                                        comment</a>
                                @endif
                            </div>
                        </form>
                    </div>

                </div>

                <!-- Comments List -->
                <div>

                    <ul id="comments-list" class="comments-list">
                        {{--<li>
                            <div class="comment-main-level">
                                <!-- Avatar -->
                                <div class="comment-avatar"><img
                                            src="https://api.adorable.io/avatars/285/goran@gmail.com" alt=""></div>
                                <!-- Contenedor del Comentario -->
                                <div class="comment-box">
                                    <div class="comment-head">
                                        <h6 class="comment-name by-author"><a
                                                    href="http://creaticode.com/blog">goran</a></h6>
                                        <span>2018-05-26 02:06:16</span>

                                        <i class="fa fa-times"></i>
                                    </div>
                                    <div class="comment-content">
                                        Lorem ipsum dolor sit amet, consectetur adipisicing elit. Velit omnis animi et
                                        iure laudantium vitae, praesentium optio, sapiente distinctio illo?
                                    </div>
                                </div>
                            </div>
                        </li>


                        <li>
                            <div class="comment-main-level">
                                <!-- Avatar -->
                                <div class="comment-avatar"><img
                                            src="https://api.adorable.io/avatars/285/nikola@gmail.com" alt=""></div>
                                <!-- Contenedor del Comentario -->
                                <div class="comment-box">
                                    <div class="comment-head">
                                        <h6 class="comment-name"><a href="http://creaticode.com/blog">nikola</a></h6>
                                        <span> at 2018-05-26 02:06:16</span>
                                        <i class="fa fa-reply"></i>
                                        <i class="fa fa-heart"></i>
                                    </div>
                                    <div class="comment-content">
                                        Lorem ipsum dolor sit amet, consectetur adipisicing elit. Velit omnis animi et
                                        iure laudantium vitae, praesentium optio, sapiente distinctio illo?
                                    </div>
                                </div>
                            </div>
                        </li>--}}
                    </ul>

                    <!-- /one comment - Foreach -->
                </div>
                <!-- /Comments List -->


            </div>
        </div>

    </div>
    <!-- -->
@endsection

@section('jsfiles')
    <script src="https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.3.4/owl.carousel.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/magnific-popup.js/1.1.0/jquery.magnific-popup.js"></script>
    <script src="https://cdn.rawgit.com/hustcc/timeago.js/e8354c59/dist/timeago.min.js"></script>
    <script>
        var idGameSubmission = "{{$gameSubmission->idGameSubmission}}";
        var idGameSubmissionUserCreatorId = "{{$gameSubmission->idUserCreator}}";
        $(document).ready(function () {
            slamjam.common.confirmBox($("#btn-remove-game-jam"));

            slamjam.games.initOneGamePage();
            slamjam.badges.initBadgesOnGamesPage();
            slamjam.comments.initGameSubmissionComments();
        });
    </script>
@endsection